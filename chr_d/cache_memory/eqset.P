(:-compiler_options([singleton_warnings_off])).

(:-import install_verify_attribute_handler / 4  ','  get_attr / 3  ','  put_attr / 3  from  machine).

(:-local attr_unify_hook / 2).

(:-install_verify_attribute_handler(eqset,A,B,attr_unify_hook(A,B))).

(:-import ground / 1  ','  member / 2  ','  append / 3  ','  ith / 3  from  basics).

(:-import delete_ith / 4  from  listutil).

(:-[attv_aux]).

get_par_list([A|B],C) :-
        get_par_list(B,D),
        (  var(A) ->
             C = [A|D]
        ;
             A =.. [E|F],
             get_par_list(F,G),
             append(G,D,C)
        ).

get_par_list([],[]).

subset([],A).

subset([A|B],C) :-
        var_member(A,C),
        subset(B,C).

intersect(A,[],[]).

intersect(A,[B|C],[B|D]) :-
        var_member(B,A),
        intersect(A,C,D).

intersect(A,[B|C],D) :-
        \+var_member(B,A),
        intersect(A,C,D).

var_member(A,[B|C]) :-
        A == B.

var_member(A,[B|C]) :-
        A \== B,
        var_member(A,C).

check_arg_pairs([],[],A).

check_arg_pairs([A|B],[C|D],E) :-
        atom(A),
        !,
        A == C,
        check_arg_pairs(B,D,E).

check_arg_pairs([A|B],[C|D],E) :-
        atom(C),
        !,
        check_arg_pairs(B,D,E).

check_arg_pairs([A|B],[C|D],E) :-
        var(A),
        (
             var_member(A,E),
             var_member(C,E),
             A == C
        ;
             \+var_member(A,E),
             \+var_member(C,E)
        ),
        check_arg_pairs(B,D,E).

check_arg_pairs([A|B],[C|D],E) :-
        compound(A),
        A =.. [F|G],
        C =.. [H|I],
        check_arg_pairs(G,I,E),
        check_arg_pairs(B,D,E).

(:-attribute neq / 2  ','  in_set / 3  ','  nin_set / 2  ','  is_in_set / 2  ','  set_add / 3  ','  set_remove / 2  ','  project1 / 2  ','  project2 / 2  ','  project_in_set / 2  ','  project_nin_set / 2).

attr_unify_hook(v(A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V),W) :-
        (  var(W) ->
             get_eqset_atts(W,X,Y,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1),
             merge_attr_lists([A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V],[X,Y,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1],[T1,U1,V1,W1,X1,Y1,Z1,A2,B2,C2,D2,E2,F2,G2,H2,I2,J2,K2,L2,M2,N2,O2]),
             pose_all_constr([neq / 2,in_set / 3,nin_set / 2,is_in_set / 2,set_add / 3,set_remove / 2,project1 / 2,project2 / 2,project_in_set / 2,project_nin_set / 2],1,W,[T1,U1,V1,W1,X1,Y1,Z1,A2,B2,C2,D2,E2,F2,G2,H2,I2,J2,K2,L2,M2,N2,O2])
        ;
             pose_all_constr([neq / 2,in_set / 3,nin_set / 2,is_in_set / 2,set_add / 3,set_remove / 2,project1 / 2,project2 / 2,project_in_set / 2,project_nin_set / 2],1,W,[A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V])
        ).

get_eqset_atts(A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W) :-
        (  get_attr(A,eqset,v(B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W)) ->
             true
        ;
             W = [],
             V = [],
             U = [],
             T = [],
             S = [],
             R = [],
             Q = [],
             P = [],
             O = [],
             N = [],
             M = [],
             L = [],
             K = [],
             J = [],
             I = [],
             H = [],
             G = [],
             F = [],
             E = [],
             D = [],
             C = [],
             B = []
        ).

put_eqset_atts(A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W) :-
        nf_put_atts(A,eqset,v(B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W)).

check_neq(A,B) :-
        var_in_list([A,B]),
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             var_member(attr(B),C)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Y,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1),
             var_member(attr(A),Z)
        ;
             true
        ).

check_in_set(A,B,C) :-
        var_in_list([A,B,C]),
        (  var(A) ->
             get_eqset_atts(A,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y),
             var_member(attr(B,C),F)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1),
             var_member(attr(A,C),C1)
        ;
             true
        ),
        (  var(C) ->
             get_eqset_atts(C,V1,W1,X1,Y1,Z1,A2,B2,C2,D2,E2,F2,G2,H2,I2,J2,K2,L2,M2,N2,O2,P2,Q2),
             var_member(attr(A,B),Z1)
        ;
             true
        ).

check_nin_set(A,B) :-
        var_in_list([A,B]),
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             var_member(attr(B),H)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Y,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1),
             var_member(attr(A),E1)
        ;
             true
        ).

check_is_in_set(A,B) :-
        var_in_list([A,B]),
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             var_member(attr(B),J)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Y,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1),
             var_member(attr(A),G1)
        ;
             true
        ).

check_set_add(A,B,C) :-
        var_in_list([A,B,C]),
        (  var(A) ->
             get_eqset_atts(A,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y),
             var_member(attr(B,C),M)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1),
             var_member(attr(A,C),J1)
        ;
             true
        ),
        (  var(C) ->
             get_eqset_atts(C,V1,W1,X1,Y1,Z1,A2,B2,C2,D2,E2,F2,G2,H2,I2,J2,K2,L2,M2,N2,O2,P2,Q2),
             var_member(attr(A,B),G2)
        ;
             true
        ).

check_set_remove(A,B) :-
        var_in_list([A,B]),
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             var_member(attr(B),O)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Y,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1),
             var_member(attr(A),L1)
        ;
             true
        ).

check_project1(A,B) :-
        var_in_list([A,B]),
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             var_member(attr(B),Q)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Y,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1),
             var_member(attr(A),N1)
        ;
             true
        ).

check_project2(A,B) :-
        var_in_list([A,B]),
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             var_member(attr(B),S)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Y,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1),
             var_member(attr(A),P1)
        ;
             true
        ).

check_project_in_set(A,B) :-
        var_in_list([A,B]),
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             var_member(attr(B),U)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Y,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1),
             var_member(attr(A),R1)
        ;
             true
        ).

check_project_nin_set(A,B) :-
        var_in_list([A,B]),
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             var_member(attr(B),W)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Y,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1),
             var_member(attr(A),T1)
        ;
             true
        ).

match_neq(A,B) :-
        var(A),
        get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(B),C).

match_neq(A,B) :-
        var(B),
        get_eqset_atts(B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(A),D).

match_in_set(A,B,C) :-
        var(A),
        get_eqset_atts(A,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y),
        member(attr(B,C),F).

match_in_set(A,B,C) :-
        var(B),
        get_eqset_atts(B,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y),
        member(attr(A,C),G).

match_in_set(A,B,C) :-
        var(C),
        get_eqset_atts(C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y),
        member(attr(A,B),H).

match_nin_set(A,B) :-
        var(A),
        get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(B),H).

match_nin_set(A,B) :-
        var(B),
        get_eqset_atts(B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(A),I).

match_is_in_set(A,B) :-
        var(A),
        get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(B),J).

match_is_in_set(A,B) :-
        var(B),
        get_eqset_atts(B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(A),K).

match_set_add(A,B,C) :-
        var(A),
        get_eqset_atts(A,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y),
        member(attr(B,C),M).

match_set_add(A,B,C) :-
        var(B),
        get_eqset_atts(B,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y),
        member(attr(A,C),N).

match_set_add(A,B,C) :-
        var(C),
        get_eqset_atts(C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y),
        member(attr(A,B),O).

match_set_remove(A,B) :-
        var(A),
        get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(B),O).

match_set_remove(A,B) :-
        var(B),
        get_eqset_atts(B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(A),P).

match_project1(A,B) :-
        var(A),
        get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(B),Q).

match_project1(A,B) :-
        var(B),
        get_eqset_atts(B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(A),R).

match_project2(A,B) :-
        var(A),
        get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(B),S).

match_project2(A,B) :-
        var(B),
        get_eqset_atts(B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(A),T).

match_project_in_set(A,B) :-
        var(A),
        get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(B),U).

match_project_in_set(A,B) :-
        var(B),
        get_eqset_atts(B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(A),V).

match_project_nin_set(A,B) :-
        var(A),
        get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(B),W).

match_project_nin_set(A,B) :-
        var(B),
        get_eqset_atts(B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
        member(attr(A),X).

add_neq(A,B) :-
        (  check_neq(A,B) ->
             true
        ;
             add_neq_1(A,B)
        ).

add_neq_1(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             append_unique(A,C,[attr(B)],Y),
             put_eqset_atts(A,Y,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1),
             append_unique(B,A1,[attr(A)],V1),
             put_eqset_atts(B,Z,V1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1)
        ;
             true
        ).

add_in_set(A,B,C) :-
        (  check_in_set(A,B,C) ->
             true
        ;
             add_in_set_1(A,B,C)
        ).

add_in_set_1(A,B,C) :-
        (  var(A) ->
             get_eqset_atts(A,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y),
             append_unique(A,F,[attr(B,C)],Z),
             put_eqset_atts(A,D,E,Z,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1),
             append_unique(B,D1,[attr(A,C)],W1),
             put_eqset_atts(B,A1,B1,C1,W1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1)
        ;
             true
        ),
        (  var(C) ->
             get_eqset_atts(C,X1,Y1,Z1,A2,B2,C2,D2,E2,F2,G2,H2,I2,J2,K2,L2,M2,N2,O2,P2,Q2,R2,S2),
             append_unique(C,B2,[attr(A,B)],T2),
             put_eqset_atts(C,X1,Y1,Z1,A2,T2,C2,D2,E2,F2,G2,H2,I2,J2,K2,L2,M2,N2,O2,P2,Q2,R2,S2)
        ;
             true
        ).

add_nin_set(A,B) :-
        (  check_nin_set(A,B) ->
             true
        ;
             add_nin_set_1(A,B)
        ).

add_nin_set_1(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             append_unique(A,H,[attr(B)],Y),
             put_eqset_atts(A,C,D,E,F,G,Y,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1),
             append_unique(B,F1,[attr(A)],V1),
             put_eqset_atts(B,Z,A1,B1,C1,D1,E1,V1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1)
        ;
             true
        ).

add_is_in_set(A,B) :-
        (  check_is_in_set(A,B) ->
             true
        ;
             add_is_in_set_1(A,B)
        ).

add_is_in_set_1(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             append_unique(A,J,[attr(B)],Y),
             put_eqset_atts(A,C,D,E,F,G,H,I,Y,K,L,M,N,O,P,Q,R,S,T,U,V,W,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1),
             append_unique(B,H1,[attr(A)],V1),
             put_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,V1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1)
        ;
             true
        ).

add_set_add(A,B,C) :-
        (  check_set_add(A,B,C) ->
             true
        ;
             add_set_add_1(A,B,C)
        ).

add_set_add_1(A,B,C) :-
        (  var(A) ->
             get_eqset_atts(A,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y),
             append_unique(A,M,[attr(B,C)],Z),
             put_eqset_atts(A,D,E,F,G,H,I,J,K,L,Z,N,O,P,Q,R,S,T,U,V,W,X,Y)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1),
             append_unique(B,K1,[attr(A,C)],W1),
             put_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,W1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1)
        ;
             true
        ),
        (  var(C) ->
             get_eqset_atts(C,X1,Y1,Z1,A2,B2,C2,D2,E2,F2,G2,H2,I2,J2,K2,L2,M2,N2,O2,P2,Q2,R2,S2),
             append_unique(C,I2,[attr(A,B)],T2),
             put_eqset_atts(C,X1,Y1,Z1,A2,B2,C2,D2,E2,F2,G2,H2,T2,J2,K2,L2,M2,N2,O2,P2,Q2,R2,S2)
        ;
             true
        ).

add_set_remove(A,B) :-
        (  check_set_remove(A,B) ->
             true
        ;
             add_set_remove_1(A,B)
        ).

add_set_remove_1(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             append_unique(A,O,[attr(B)],Y),
             put_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,Y,P,Q,R,S,T,U,V,W,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1),
             append_unique(B,M1,[attr(A)],V1),
             put_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,V1,N1,O1,P1,Q1,R1,S1,T1,U1)
        ;
             true
        ).

add_project1(A,B) :-
        (  check_project1(A,B) ->
             true
        ;
             add_project1_1(A,B)
        ).

add_project1_1(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             append_unique(A,Q,[attr(B)],Y),
             put_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Y,R,S,T,U,V,W,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1),
             append_unique(B,O1,[attr(A)],V1),
             put_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,V1,P1,Q1,R1,S1,T1,U1)
        ;
             true
        ).

add_project2(A,B) :-
        (  check_project2(A,B) ->
             true
        ;
             add_project2_1(A,B)
        ).

add_project2_1(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             append_unique(A,S,[attr(B)],Y),
             put_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,Y,T,U,V,W,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1),
             append_unique(B,Q1,[attr(A)],V1),
             put_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,V1,R1,S1,T1,U1)
        ;
             true
        ).

add_project_in_set(A,B) :-
        (  check_project_in_set(A,B) ->
             true
        ;
             add_project_in_set_1(A,B)
        ).

add_project_in_set_1(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             append_unique(A,U,[attr(B)],Y),
             put_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,Y,V,W,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1),
             append_unique(B,S1,[attr(A)],V1),
             put_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,V1,T1,U1)
        ;
             true
        ).

add_project_nin_set(A,B) :-
        (  check_project_nin_set(A,B) ->
             true
        ;
             add_project_nin_set_1(A,B)
        ).

add_project_nin_set_1(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             append_unique(A,W,[attr(B)],Y),
             put_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,Y,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1),
             append_unique(B,U1,[attr(A)],V1),
             put_eqset_atts(B,Z,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,V1)
        ;
             true
        ).

remove_neq(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             abs_ith(Y,C,attr(B)),
             delete_ith(Y,C,attr(B),Z),
             put_eqset_atts(A,Z,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1),
             abs_ith(W1,B1,attr(A)),
             delete_ith(W1,B1,attr(A),X1),
             put_eqset_atts(B,A1,X1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1)
        ;
             true
        ).

remove_in_set(A,B,C) :-
        (  var(A) ->
             get_eqset_atts(A,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y),
             abs_ith(Z,F,attr(B,C)),
             delete_ith(Z,F,attr(B,C),A1),
             put_eqset_atts(A,D,E,A1,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1,W1),
             abs_ith(X1,E1,attr(A,C)),
             delete_ith(X1,E1,attr(A,C),Y1),
             put_eqset_atts(B,B1,C1,D1,Y1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1,W1)
        ;
             true
        ),
        (  var(C) ->
             get_eqset_atts(C,Z1,A2,B2,C2,D2,E2,F2,G2,H2,I2,J2,K2,L2,M2,N2,O2,P2,Q2,R2,S2,T2,U2),
             abs_ith(V2,D2,attr(A,B)),
             delete_ith(V2,D2,attr(A,B),W2),
             put_eqset_atts(C,Z1,A2,B2,C2,W2,E2,F2,G2,H2,I2,J2,K2,L2,M2,N2,O2,P2,Q2,R2,S2,T2,U2)
        ;
             true
        ).

remove_nin_set(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             abs_ith(Y,H,attr(B)),
             delete_ith(Y,H,attr(B),Z),
             put_eqset_atts(A,C,D,E,F,G,Z,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1),
             abs_ith(W1,G1,attr(A)),
             delete_ith(W1,G1,attr(A),X1),
             put_eqset_atts(B,A1,B1,C1,D1,E1,F1,X1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1)
        ;
             true
        ).

remove_is_in_set(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             abs_ith(Y,J,attr(B)),
             delete_ith(Y,J,attr(B),Z),
             put_eqset_atts(A,C,D,E,F,G,H,I,Z,K,L,M,N,O,P,Q,R,S,T,U,V,W,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1),
             abs_ith(W1,I1,attr(A)),
             delete_ith(W1,I1,attr(A),X1),
             put_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,X1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1)
        ;
             true
        ).

remove_set_add(A,B,C) :-
        (  var(A) ->
             get_eqset_atts(A,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y),
             abs_ith(Z,M,attr(B,C)),
             delete_ith(Z,M,attr(B,C),A1),
             put_eqset_atts(A,D,E,F,G,H,I,J,K,L,A1,N,O,P,Q,R,S,T,U,V,W,X,Y)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1,W1),
             abs_ith(X1,L1,attr(A,C)),
             delete_ith(X1,L1,attr(A,C),Y1),
             put_eqset_atts(B,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,Y1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1,W1)
        ;
             true
        ),
        (  var(C) ->
             get_eqset_atts(C,Z1,A2,B2,C2,D2,E2,F2,G2,H2,I2,J2,K2,L2,M2,N2,O2,P2,Q2,R2,S2,T2,U2),
             abs_ith(V2,K2,attr(A,B)),
             delete_ith(V2,K2,attr(A,B),W2),
             put_eqset_atts(C,Z1,A2,B2,C2,D2,E2,F2,G2,H2,I2,J2,W2,L2,M2,N2,O2,P2,Q2,R2,S2,T2,U2)
        ;
             true
        ).

remove_set_remove(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             abs_ith(Y,O,attr(B)),
             delete_ith(Y,O,attr(B),Z),
             put_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,Z,P,Q,R,S,T,U,V,W,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1),
             abs_ith(W1,N1,attr(A)),
             delete_ith(W1,N1,attr(A),X1),
             put_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,X1,O1,P1,Q1,R1,S1,T1,U1,V1)
        ;
             true
        ).

remove_project1(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             abs_ith(Y,Q,attr(B)),
             delete_ith(Y,Q,attr(B),Z),
             put_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Z,R,S,T,U,V,W,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1),
             abs_ith(W1,P1,attr(A)),
             delete_ith(W1,P1,attr(A),X1),
             put_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,X1,Q1,R1,S1,T1,U1,V1)
        ;
             true
        ).

remove_project2(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             abs_ith(Y,S,attr(B)),
             delete_ith(Y,S,attr(B),Z),
             put_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,Z,T,U,V,W,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1),
             abs_ith(W1,R1,attr(A)),
             delete_ith(W1,R1,attr(A),X1),
             put_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,X1,S1,T1,U1,V1)
        ;
             true
        ).

remove_project_in_set(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             abs_ith(Y,U,attr(B)),
             delete_ith(Y,U,attr(B),Z),
             put_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,Z,V,W,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1),
             abs_ith(W1,T1,attr(A)),
             delete_ith(W1,T1,attr(A),X1),
             put_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,X1,U1,V1)
        ;
             true
        ).

remove_project_nin_set(A,B) :-
        (  var(A) ->
             get_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X),
             abs_ith(Y,W,attr(B)),
             delete_ith(Y,W,attr(B),Z),
             put_eqset_atts(A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,Z,X)
        ;
             true
        ),
        (  var(B) ->
             get_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1),
             abs_ith(W1,V1,attr(A)),
             delete_ith(W1,V1,attr(A),X1),
             put_eqset_atts(B,A1,B1,C1,D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,X1)
        ;
             true
        ).

neq(A,B) :-
        neq_eval_1(A,B).

neq_eval_1(A,B) :-
        (
          B == A,
          true,
          true,
          true ->
             fail
        ;
             neq_eval_2(A,B)
        ).

neq_eval_2(A,B) :-
        (
          true,
          true,
          check_neq(B,A),
          true ->
             true,
             true
        ;
             neq_eval_3(A,B)
        ).

neq_eval_3(A,B) :-
        !,
        add_neq(A,B).

in_set(A,B,C) :-
        in_set_eval_1(A,B,C).

in_set_eval_1(A,B,C) :-
        (
          true,
          true,
          match_nin_set(D,C),
          A == D ->
             fail
        ;
             in_set_eval_2(A,B,C)
        ).

in_set_eval_2(A,B,C) :-
        (
          true,
          true,
          match_in_set(A,D,C),
          D \== B ->
             true,
             fail
        ;
             in_set_eval_3(A,B,C)
        ).

in_set_eval_3(A,B,C) :-
        (
          true,
          true,
          check_is_in_set(A,C),
          true ->
             true
        ;
             in_set_eval_4(A,B,C)
        ).

in_set_eval_4(A,B,C) :-
        !,
        add_in_set(A,B,C).

nin_set(A,B) :-
        nin_set_eval_1(A,B).

nin_set_eval_1(A,B) :-
        (
          true,
          true,
          match_in_set(C,D,B),
          C == A ->
             fail
        ;
             nin_set_eval_2(A,B)
        ).

nin_set_eval_2(A,B) :-
        (
          true,
          true,
          match_project_nin_set(B,C),
          \+var_member(A,C) ->
             true,
             true
        ;
             nin_set_eval_3(A,B)
        ).

nin_set_eval_3(A,B) :-
        !,
        add_nin_set(A,B).

is_in_set(A,B) :-
        is_in_set_eval_1(A,B).

is_in_set_eval_1(A,B) :-
        (
          true,
          true,
          match_in_set(A,C,B),
          true ->
             true
        ;
             is_in_set_eval_2(A,B)
        ).

is_in_set_eval_2(A,B) :-
        (
          true,
          true,
          true,
          true ->
             fail
        ;
             is_in_set_eval_3(A,B)
        ).

is_in_set_eval_3(A,B) :-
        !,
        add_is_in_set(A,B).

set_add(A,B,C) :-
        set_add_eval_1(A,B,C).

set_add_eval_1(A,B,C) :-
        (
          true,
          true,
          get_nth_attr(A,eqset,6,D),
          get_nth_attr(C,eqset,7,E) ->
             set_add_eval_1_1(A,B,C,D,E),
             set_add_eval_2(A,B,C)
        ;
             set_add_eval_2(A,B,C)
        ).

set_add_eval_1_1(A,B,C,[],D).

set_add_eval_1_1(A,B,C,[attr(D)|E],F) :-
        (
          D == C,
          check_nin_set(A,C),
          true ->
             remove_nin_set(A,C),
             true,
             set_add_eval_1_2(A,B,C,D,F)
        ;
             true
        ),
        set_add_eval_1_1(A,B,C,E,F).

set_add_eval_1_2(A,B,C,D,[]).

set_add_eval_1_2(A,B,C,D,[attr(E)|F]) :-
        (
          E == A,
          check_nin_set(A,C),
          true ->
             true,
             in_set(A,B,C)
        ;
             true
        ),
        set_add_eval_1_2(A,B,C,D,F).

set_add_eval_2(A,B,C) :-
        (
          true,
          true,
          true,
          true ->
             true
        ;
             set_add_eval_3(A,B,C)
        ).

set_add_eval_3(A,B,C) :-
        !,
        add_set_add(A,B,C).

set_remove(A,B) :-
        set_remove_eval_1(A,B).

set_remove_eval_1(A,B) :-
        (
          true,
          true,
          get_nth_attr(A,eqset,3,C),
          get_nth_attr(B,eqset,5,D) ->
             set_remove_eval_1_1(A,B,C,D),
             set_remove_eval_2(A,B)
        ;
             set_remove_eval_2(A,B)
        ).

set_remove_eval_1_1(A,B,[],C).

set_remove_eval_1_1(A,B,[attr(C,D)|E],F) :-
        (
          D == B,
          check_in_set(A,C,B),
          true ->
             remove_in_set(A,C,B),
             true,
             set_remove_eval_1_2(A,B,C,D,F)
        ;
             true
        ),
        set_remove_eval_1_1(A,B,E,F).

set_remove_eval_1_2(A,B,C,D,[]).

set_remove_eval_1_2(A,B,C,D,[attr(E,F)|G]) :-
        (
          E == A,
          F == C,
          check_in_set(A,C,B),
          true ->
             true,
             nin_set(A,B)
        ;
             true
        ),
        set_remove_eval_1_2(A,B,C,D,G).

set_remove_eval_2(A,B) :-
        (
          true,
          true,
          true,
          true ->
             true
        ;
             set_remove_eval_3(A,B)
        ).

set_remove_eval_3(A,B) :-
        !,
        add_set_remove(A,B).

project1(A,B) :-
        project1_eval_1(A,B).

project1_eval_1(A,B) :-
        (
          true,
          true,
          get_nth_attr(A,eqset,1,C) ->
             project1_eval_1_1(A,B,C),
             project1_eval_2(A,B)
        ;
             project1_eval_2(A,B)
        ).

project1_eval_1_1(A,B,[]).

project1_eval_1_1(A,B,[attr(C)|D]) :-
        (
          true,
          check_neq(A,C),
          true ->
             true,
             get_nth_attr(A,eqset,1,E),
             project1_eval_1_2(A,B,C,E)
        ;
             true
        ),
        project1_eval_1_1(A,B,D).

project1_eval_1_2(A,B,C,[]).

project1_eval_1_2(A,B,C,[attr(D)|E]) :-
        (
          true,
          check_neq(A,D),
          C \== D,
          check_arg_pairs([C],[D],B) ->
             remove_neq(A,D),
             true
        ;
             true
        ),
        project1_eval_1_2(A,B,C,E).

project1_eval_2(A,B) :-
        (
          true,
          true,
          true,
          true ->
             true
        ;
             project1_eval_3(A,B)
        ).

project1_eval_3(A,B) :-
        !,
        add_project1(A,B).

project2(A,B) :-
        project2_eval_1(A,B).

project2_eval_1(A,B) :-
        (
          true,
          true,
          get_nth_attr(A,eqset,2,C) ->
             project2_eval_1_1(A,B,C),
             project2_eval_2(A,B)
        ;
             project2_eval_2(A,B)
        ).

project2_eval_1_1(A,B,[]).

project2_eval_1_1(A,B,[attr(C)|D]) :-
        (
          true,
          check_neq(C,A),
          true ->
             true,
             get_nth_attr(A,eqset,2,E),
             project2_eval_1_2(A,B,C,E)
        ;
             true
        ),
        project2_eval_1_1(A,B,D).

project2_eval_1_2(A,B,C,[]).

project2_eval_1_2(A,B,C,[attr(D)|E]) :-
        (
          true,
          check_neq(D,A),
          C \== D,
          check_arg_pairs([C],[D],B) ->
             remove_neq(D,A),
             true
        ;
             true
        ),
        project2_eval_1_2(A,B,C,E).

project2_eval_2(A,B) :-
        (
          true,
          true,
          true,
          true ->
             true
        ;
             project2_eval_3(A,B)
        ).

project2_eval_3(A,B) :-
        !,
        add_project2(A,B).

project_in_set(A,B) :-
        project_in_set_eval_1(A,B).

project_in_set_eval_1(A,B) :-
        (
          true,
          true,
          get_nth_attr(A,eqset,5,C) ->
             project_in_set_eval_1_1(A,B,C),
             project_in_set_eval_2(A,B)
        ;
             project_in_set_eval_2(A,B)
        ).

project_in_set_eval_1_1(A,B,[]).

project_in_set_eval_1_1(A,B,[attr(C,D)|E]) :-
        (
          true,
          check_in_set(C,D,A),
          true ->
             true,
             get_nth_attr(A,eqset,5,F),
             project_in_set_eval_1_2(A,B,C,D,F)
        ;
             true
        ),
        project_in_set_eval_1_1(A,B,E).

project_in_set_eval_1_2(A,B,C,D,[]).

project_in_set_eval_1_2(A,B,C,D,[attr(E,F)|G]) :-
        (
          true,
          check_in_set(E,F,A),
          C \== E,
          D \== F,
          check_arg_pairs([C,D],[E,F],B) ->
             remove_in_set(E,F,A),
             true
        ;
             true
        ),
        project_in_set_eval_1_2(A,B,C,D,G).

project_in_set_eval_2(A,B) :-
        (
          true,
          true,
          true,
          true ->
             true
        ;
             project_in_set_eval_3(A,B)
        ).

project_in_set_eval_3(A,B) :-
        !,
        add_project_in_set(A,B).

project_nin_set(A,B) :-
        project_nin_set_eval_1(A,B).

project_nin_set_eval_1(A,B) :-
        (
          true,
          true,
          get_nth_attr(A,eqset,7,C) ->
             project_nin_set_eval_1_1(A,B,C),
             project_nin_set_eval_2(A,B)
        ;
             project_nin_set_eval_2(A,B)
        ).

project_nin_set_eval_1_1(A,B,[]).

project_nin_set_eval_1_1(A,B,[attr(C)|D]) :-
        (
          true,
          check_nin_set(C,A),
          \+var_member(C,B) ->
             remove_nin_set(C,A),
             true
        ;
             true
        ),
        project_nin_set_eval_1_1(A,B,D).

project_nin_set_eval_2(A,B) :-
        (
          true,
          true,
          true,
          true ->
             true
        ;
             project_nin_set_eval_3(A,B)
        ).

project_nin_set_eval_3(A,B) :-
        !,
        add_project_nin_set(A,B).

show_atts(A) :-
        show_atts(A,eqset).

