%% This is the program executed by child-XSB process spawned off by parent.P

:- import fd2ioport/2 from file_io.
:- import file_read_line_atom/3 from file_io.

:- dynamic pipe/1.

?- pipe(P), fd2ioport(P,F),
   %% get parent process as an atom
   read(Pr),
   %% Acknowledge receipt of the pipe
   fmt_write("\nPipe %d received from Process %S\n", arg(P,Pr)),
   %% Get a message from the parent and print it to stdout
   file_read_line_atom(F, Line,_), write('Mesage was: '), writeln(Line).
