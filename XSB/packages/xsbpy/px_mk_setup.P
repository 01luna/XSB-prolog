
:- export mk_setup/1, mk_setup/2.
:- import xsb_configuration/2 from xsb_configuration.
:- import concat_atom/2 from string.

mk_setup(File,PythonIncludeDir) :-
        writeln(2,'*** Creating the settings for the py-xsb package'),
        tell(File),
        mk_setup(PythonIncludeDir),
        told.
mk_setup(PythonIncludeDir) :-
        writeln('from distutils.core import setup, Extension'),
        xsb_configuration(packagesdir, PkgsDir),
        xsb_configuration(emudir, EmuDir),
        xsb_configuration(config_dir, ConfigDir),
        xsb_configuration(config_bindir, ConfigBinDir),
        concat_atom([PkgsDir, '/xsbpy'], XSBPy_Dir),
        writeln('module1 = Extension(\'xsbext\','),
        write('                    include_dirs = [\''), write(PythonIncludeDir), writeln('\','),
        write('                                    \''), write(EmuDir), writeln('\','),
        write('                                    \''), write(XSBPy_Dir), writeln('\','),
        write('                                    \''), write(ConfigDir), writeln('\'],'),
        writeln('                    libraries = [\'xsb\'],'),
        write('                    library_dirs = [\''), write(ConfigBinDir), writeln('\'],'),
        writeln('                    sources = [\'px/xsbext.c\', \'px/xsbpy_common.c\'])'),
        writeln('
setup (name = \'px\',
       version = \'0.1\',
       description = \'Embedding XSB in Python\',
       author = \'Theresa Swift\',
       ext_modules = [module1])
').
