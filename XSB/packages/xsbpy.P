:- compiler_options([xpp_on]).

#include "xsbpy/xsbpy_defs.h"

:- export callpy/3, add_py_lib_dir/1, py_lib_dirs/1.
:- export callpy/4.

:- import bootstrap_package/2 from packaging.

%cfa - this command is here because of a bug involving loading .xwams - calls to putenv/0 do not work from them
%:- (path_sysop(rm,'./xsbpy/ld_pymod.xwam') -> true ; true) .

:- bootstrap_package(xsbpy, xsbpy),[init_xsbpy].

%:- import callpy/3 from xsbpym as callpy/3.
:- import callpy_int/4 from xsbpym.
:- import add_py_lib_dir/1 from init_xsbpy as add_py_lib_dir/1.
:- import py_lib_dirs/1 from init_xsbpy as py_lib_dirs/1.

callpy(Mod,Func,Def_vars,Ret):-
    def_vars_to_dict(Def_vars,Dict),
    callpy_int(Mod,Func,Dict,Ret).

callpy(Mod,Func,Ret):-
    callpy_int(Mod,Func,0,Ret).

def_vars_to_dict(X,PYDICT_PROLOG(Y)):-
    def_vars_to_dict_1(X,Y).

def_vars_to_dict_1([],[]).
def_vars_to_dict_1([A=B|T],[''(A,B)|T1]):-
    def_vars_to_dict_1(T,T1).

