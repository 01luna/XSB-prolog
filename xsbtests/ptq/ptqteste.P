/*
:- op(200, xfy,[\]).    % lambda when bound var occurs only once
:- op(190, yfx,[@]).
:- op(150, fx,[^]).
:- op(150, fx,[*]).
*/

:- tabled(srev/5).

:- srev(_,_,_,_,_),fail.

%st(r14,T,(X,Te,T1))  :- T  = Te'@' '^'(X'\'T1).

st(r14,T,(X,Te,T1))  :- T  = '@'(Te,'^'('\'(X,T1))).

srev(T,Sa,Sb,A,B):- sc2(T,Sa,Sb,A,B).
srev(T,Sa,Sb,A,B):-                  % s14
        srev(T1,Sa,Sb1,A,B),
	delete(sub(Te,X,_),Sb1,Sb), 
%	write(Te),nl,
        st(r14,T,(X,Te,T1)).
	
delete(X,[X|L],L).
delete(X,[Y|L0],[Y|L1]) :- delete(X,L0,L1).

sc2(foo,[],'.'(sub('\'(A,'@'(*(A),'^'(j))),B,m),'.'(sub('\'(C,'@'(*(C),'^'(m))),D,f),[])),0,3).

/*
sc2(foo,[],'.'(sub('\'(H,'@'(*(H),'^'(j))),B,m),'.'(sub('\'(I,'@'(*(I),'^'(m))),G,f),[])),0,3).
*/