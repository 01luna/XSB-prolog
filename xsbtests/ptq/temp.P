non_red(T) :- term_type(T,Ty),
	(Ty =:= 1	% struct
	 ->	term_psc(T,Psc),
		term_psc(_@_,Atpsc),
		(Psc =:= Atpsc
		 ->	T=F@A,
			term_type(F,Fty),
			(Fty =:= 1
			 ->	term_psc(F,Tpsc),
				term_psc(_\_,Lampsc),
				(Tpsc =\= Lampsc
				 ->	non_red(F),
					non_red(A)
				)
			 ;	non_red(A)
			)
		 ;	term_psc(*_,Astpsc),
			(Psc =:= Astpsc
			 ->	T = *Int,
				term_type(Int,Ity),
				(Ity =:= 1
				 ->	term_psc(Int,Apsc),
					term_psc(^_,Intpsc),
					(Apsc =\= Intpsc
					 ->	non_red(Int)
					)
				 ;	true
				)
			 ;	psc_arity(Psc,N),
				non_red(T,N)
			)
		)
	 ;	true
	).

cred(T,S,N) :-
	N =:= 0
	 ->	true
	 ;	term_arg(T,N,A),
		cred(A,A1),
		term_arg(S,N,A0),
		A0=A1,
		N1 is N-1,
		cred(T,S,N1).
